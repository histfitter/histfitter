
TGraph* ATLAS_EPS_mglmsq(){
   TGraph *EPS_mglmsq = new TGraph(58);
   EPS_mglmsq->SetName("EPS_mglmsq");
   EPS_mglmsq->SetTitle("EPS_mglmsq");
   EPS_mglmsq->SetFillColor(kBlue-10);
   EPS_mglmsq->SetLineColor(kGray+1);
   EPS_mglmsq->SetLineWidth(2);

   EPS_mglmsq->SetPoint(0,715.3946,1976.25);
   EPS_mglmsq->SetPoint(1,716.366,1928.75);
   EPS_mglmsq->SetPoint(2,717.22,1881.25);
   EPS_mglmsq->SetPoint(3,717.5,1865.184);
   EPS_mglmsq->SetPoint(4,717.8876,1833.75);
   EPS_mglmsq->SetPoint(5,719.0077,1786.25);
   EPS_mglmsq->SetPoint(6,721.1461,1738.75);
   EPS_mglmsq->SetPoint(7,721.7707,1691.25);
   EPS_mglmsq->SetPoint(8,722.1917,1643.75);
   EPS_mglmsq->SetPoint(9,723.131,1596.25);
   EPS_mglmsq->SetPoint(10,730.6822,1548.75);
   EPS_mglmsq->SetPoint(11,736.8447,1501.25);
   EPS_mglmsq->SetPoint(12,743.1338,1453.75);
   EPS_mglmsq->SetPoint(13,747.9427,1406.25);
   EPS_mglmsq->SetPoint(14,762.5,1378.617);
   EPS_mglmsq->SetPoint(15,773.3507,1358.75);
   EPS_mglmsq->SetPoint(16,802.4692,1311.25);
   EPS_mglmsq->SetPoint(17,807.5,1303.044);
   EPS_mglmsq->SetPoint(18,837.0141,1263.75);
   EPS_mglmsq->SetPoint(19,852.5,1243.133);
   EPS_mglmsq->SetPoint(20,871.159,1216.25);
   EPS_mglmsq->SetPoint(21,897.5,1195.193);
   EPS_mglmsq->SetPoint(22,931.1171,1168.75);
   EPS_mglmsq->SetPoint(23,942.5,1161.947);
   EPS_mglmsq->SetPoint(24,987.5,1130.631);
   EPS_mglmsq->SetPoint(25,1005.078,1121.25);
   EPS_mglmsq->SetPoint(26,1032.5,1106.616);
   EPS_mglmsq->SetPoint(27,1077.5,1085.41);
   EPS_mglmsq->SetPoint(28,1102.243,1073.75);
   EPS_mglmsq->SetPoint(29,1122.5,1064.204);
   EPS_mglmsq->SetPoint(30,1167.5,1039.294);
   EPS_mglmsq->SetPoint(31,1195.589,1026.25);
   EPS_mglmsq->SetPoint(32,1212.5,1019.312);
   EPS_mglmsq->SetPoint(33,1257.5,1008.976);
   EPS_mglmsq->SetPoint(34,1302.5,997.4385);
   EPS_mglmsq->SetPoint(35,1347.5,985.9006);
   EPS_mglmsq->SetPoint(36,1375.389,978.75);
   EPS_mglmsq->SetPoint(37,1392.5,975.1233);
   EPS_mglmsq->SetPoint(38,1437.5,968.4824);
   EPS_mglmsq->SetPoint(39,1482.5,962.2247);
   EPS_mglmsq->SetPoint(40,1527.5,955.4612);
   EPS_mglmsq->SetPoint(41,1572.5,948.1507);
   EPS_mglmsq->SetPoint(42,1617.5,941.5824);
   EPS_mglmsq->SetPoint(43,1662.5,936.8981);
   EPS_mglmsq->SetPoint(44,1707.5,931.3033);
   EPS_mglmsq->SetPoint(45,1707.921,931.25);
   EPS_mglmsq->SetPoint(46,1752.5,924.0574);
   EPS_mglmsq->SetPoint(47,1797.5,916.797);
   EPS_mglmsq->SetPoint(48,1842.5,915.4689);
   EPS_mglmsq->SetPoint(49,1887.5,909.596);
   EPS_mglmsq->SetPoint(50,1932.5,902.9085);
   EPS_mglmsq->SetPoint(51,1977.5,896.221);
   EPS_mglmsq->SetPoint(52,2050,890.221);
   EPS_mglmsq->SetPoint(53,2100,-50);
   EPS_mglmsq->SetPoint(54,-50,-50);
   EPS_mglmsq->SetPoint(55,-50,2100);
   EPS_mglmsq->SetPoint(56,715.3946,2050);
   EPS_mglmsq->SetPoint(57,715.3946,1976.25);

   return EPS_mglmsq;
}

TGraph* ATLAS_EPS_m0m12(){
   TGraph *EPS_m0m12 = new TGraph(84);
   EPS_m0m12->SetName("EPS_m0m12");
   EPS_m0m12->SetTitle("EPS_m0m12");
   EPS_m0m12->SetFillColor(kBlue-10);
   EPS_m0m12->SetLineColor(kGray+1);
   EPS_m0m12->SetLineWidth(2);
   
   EPS_m0m12->SetPoint(0,147,462.4601);
   EPS_m0m12->SetPoint(1,196.2665,450.375);
   EPS_m0m12->SetPoint(2,241,442.598);
   EPS_m0m12->SetPoint(3,295.9137,436.125);
   EPS_m0m12->SetPoint(4,335,430.0887);
   EPS_m0m12->SetPoint(5,381.8372,421.875);
   EPS_m0m12->SetPoint(6,429,412.0542);
   EPS_m0m12->SetPoint(7,463.6537,407.625);
   EPS_m0m12->SetPoint(8,523,399.1156);
   EPS_m0m12->SetPoint(9,550.9092,393.375);
   EPS_m0m12->SetPoint(10,617,382.7188);
   EPS_m0m12->SetPoint(11,639.605,379.125);
   EPS_m0m12->SetPoint(12,711,367.7961);
   EPS_m0m12->SetPoint(13,725.8344,364.875);
   EPS_m0m12->SetPoint(14,784.9397,350.625);
   EPS_m0m12->SetPoint(15,805,345.3524);
   EPS_m0m12->SetPoint(16,841.694,336.375);
   EPS_m0m12->SetPoint(17,887.4908,322.125);
   EPS_m0m12->SetPoint(18,899,318.4416);
   EPS_m0m12->SetPoint(19,944.8739,307.875);
   EPS_m0m12->SetPoint(20,993,296.9517);
   EPS_m0m12->SetPoint(21,1005.288,293.625);
   EPS_m0m12->SetPoint(22,1038.423,279.375);
   EPS_m0m12->SetPoint(23,1087,267.1817);
   EPS_m0m12->SetPoint(24,1096.481,265.125);
   EPS_m0m12->SetPoint(25,1174.346,250.875);
   EPS_m0m12->SetPoint(26,1181,249.4908);
   EPS_m0m12->SetPoint(27,1227.738,236.625);
   EPS_m0m12->SetPoint(28,1275,227.1472);
   EPS_m0m12->SetPoint(29,1336.43,222.375);
   EPS_m0m12->SetPoint(30,1369,217.6908);
   EPS_m0m12->SetPoint(31,1425.033,208.125);
   EPS_m0m12->SetPoint(32,1463,204.2757);
   EPS_m0m12->SetPoint(33,1557,206.1329);
   EPS_m0m12->SetPoint(34,1651,205.1361);
   EPS_m0m12->SetPoint(35,1745,198.3673);
   EPS_m0m12->SetPoint(36,1835.417,193.875);
   EPS_m0m12->SetPoint(37,1839,193.7106);
   EPS_m0m12->SetPoint(38,1848.668,193.875);
   EPS_m0m12->SetPoint(39,1933,195.6033);
   EPS_m0m12->SetPoint(40,1967.487,193.875);
   EPS_m0m12->SetPoint(41,2027,190.5165);
   EPS_m0m12->SetPoint(42,2121,191.7837);
   EPS_m0m12->SetPoint(43,2215,188.1844);
   EPS_m0m12->SetPoint(44,2309,187.1331);
   EPS_m0m12->SetPoint(45,2403,186.4464);
   EPS_m0m12->SetPoint(46,2497,186.0908);
   EPS_m0m12->SetPoint(47,2591,185.9322);
   EPS_m0m12->SetPoint(48,2685,186.5117);
   EPS_m0m12->SetPoint(49,2779,183.8549);
   EPS_m0m12->SetPoint(50,2855.457,179.625);
   EPS_m0m12->SetPoint(51,2873,177.9291);
   EPS_m0m12->SetPoint(52,2967,169.7127);
   EPS_m0m12->SetPoint(53,3028.789,165.375);
   EPS_m0m12->SetPoint(54,2974.303,151.125);
   EPS_m0m12->SetPoint(55,2967,150.018);
   EPS_m0m12->SetPoint(56,2877.291,136.875);
   EPS_m0m12->SetPoint(57,2873,136.2244);
   EPS_m0m12->SetPoint(58,2796.328,122.625);
   EPS_m0m12->SetPoint(59,2779,119.9981);
   EPS_m0m12->SetPoint(60,2685,112.9275);
   EPS_m0m12->SetPoint(61,2645.881,108.375);
   EPS_m0m12->SetPoint(62,2591,100.0553);
   EPS_m0m12->SetPoint(63,2529.395,94.125);
   EPS_m0m12->SetPoint(64,2497,89.21412);
   EPS_m0m12->SetPoint(65,2403,87.48459);
   EPS_m0m12->SetPoint(66,2353.747,79.875);
   EPS_m0m12->SetPoint(67,2309,73.09154);
   EPS_m0m12->SetPoint(68,2215,73.19648);
   EPS_m0m12->SetPoint(69,2164.766,65.625);
   EPS_m0m12->SetPoint(70,2121,58.99031);
   EPS_m0m12->SetPoint(71,2027,58.23228);
   EPS_m0m12->SetPoint(72,1933,58.1449);
   EPS_m0m12->SetPoint(73,1878.388,51.375);
   EPS_m0m12->SetPoint(74,1839,45.40398);
   EPS_m0m12->SetPoint(75,1745,44.88315);
   EPS_m0m12->SetPoint(76,1651,46.82582);
   EPS_m0m12->SetPoint(77,1557,47.97043);
   EPS_m0m12->SetPoint(78,1481.626,37.125);
   EPS_m0m12->SetPoint(79,1481.626,0);
   EPS_m0m12->SetPoint(80,0,0);
   EPS_m0m12->SetPoint(81,0,462.4601);
   EPS_m0m12->SetPoint(82,147,462.4601);
   EPS_m0m12->SetPoint(83,147,462.4601);

   return EPS_m0m12;
}

TGraph* msugra_noEWSB(TString noewsbfile) {

  TGraph* noEWSB_curv = get_noEWSB(noewsbfile);
  int npts = noEWSB_curv->GetN();
  TGraph* g_exc_noEWSB = new TGraph(npts+4);
  double x,y,y0;
  for(int i=0; i<npts; i++) {
    noEWSB_curv->GetPoint(i,x,y);
    g_exc_noEWSB->SetPoint(i,x,y);
    if(i==0) y0=y;
  }
  g_exc_noEWSB->SetPoint(npts,5000,y);
  g_exc_noEWSB->SetPoint(npts+1,5000,0);
  g_exc_noEWSB->SetPoint(npts+2,0,0);
  g_exc_noEWSB->SetPoint(npts+3,0,y0);
  g_exc_noEWSB->SetFillColor(kGreen-9);
  g_exc_noEWSB->SetLineColor(kGray+1);
  g_exc_noEWSB->SetLineWidth(1);

  return g_exc_noEWSB;
}

TGraph* get_noEWSB(TString noewsbfile) {
  TGraph2D noEWSB(noewsbfile);

  TCanvas* c_noEWSB = new TCanvas("c_noEWSB");
  
  // contour plot
  TH2* noEWSB_hist = noEWSB.GetHistogram();
  for(int iterations=0; iterations<2; iterations++) {
    for(int binx=2; binx < noEWSB_hist->GetNbinsX(); binx++) {
      for(int biny=2; biny < noEWSB_hist->GetNbinsY(); biny++) {
	double nnpp = noEWSB_hist->GetBinContent(binx+1,biny+1);
	double nnmp = noEWSB_hist->GetBinContent(binx-1,biny+1);
	double nnpm = noEWSB_hist->GetBinContent(binx+1,biny-1);
	double nnmm = noEWSB_hist->GetBinContent(binx-1,biny-1);
	noEWSB_hist->SetBinContent(binx,biny,(nnpp+nnmp+nnpm+nnmm)/4);
      }
    }
  }
  noEWSB_hist->SetContour(1);
  noEWSB_hist->SetContourLevel(0,0.57);
  noEWSB_hist->Draw("contlist");

  c_noEWSB->Update();

  TObjArray* conts_e = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_e = (TList*) conts_e->At(0);
  TGraph* curv_e = (TGraph*) cont_e->At(0)->Clone("noEWSB");

  delete c_noEWSB;

  return curv_e;
}

TGraph* msugra_lepchrg(TString chrgfile="mSugraGridtanbeta10_charginoMasses.root") {
  TGraph* lepc_curv = lep_chargino(chrgfile);
  int npts = lepc_curv->GetN();
  TGraph* g_exc_lepc = new TGraph(npts+4);
  double x,y,y0;
  for(int i=0; i<npts; i++) {
    lepc_curv->GetPoint(i,x,y);
    g_exc_lepc->SetPoint(i,x,y);
    if(i==0) y0=y;
  }
  g_exc_lepc->SetPoint(npts,0,y);
  g_exc_lepc->SetPoint(npts+1,0,0);
  g_exc_lepc->SetPoint(npts+2,5000,0);
  g_exc_lepc->SetPoint(npts+3,5000,y0);
  g_exc_lepc->SetLineColor(kGray+2);
  g_exc_lepc->SetLineWidth(2);
  g_exc_lepc->SetFillColor(kOrange-2);

  delete lepc_curv;
  return g_exc_lepc;
}

TGraph *lep_chargino(TString chrgfile) {
  TFile* mfile = TFile::Open(chrgfile);

  TCanvas* c_mChrg = new TCanvas("c_mChrg");
  
  // contour plot
  TH2F* h_mchrg = (TH2F*) mfile->Get("mSugraGrid_charginoMasses");
  h_mchrg->SetDirectory(0);
  mfile->Close();

  h_mchrg->SetContour(1);
  h_mchrg->SetContourLevel(0,94); // LEP limit

  h_mchrg->Draw( "contlist" );
  c_mChrg->Update();

  TObjArray* conts_m = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_m = (TList*) conts_m->At(0);
  TGraph* curv_m = (TGraph*) cont_m->At(0)->Clone("lep_chargino");

  delete c_mChrg;

  return curv_m;
}


TGraph *msugra_stauLSP() {
  TGraph *g_exc_stauLSP = new TGraph(50);
  g_exc_stauLSP->SetName("g_exc_stauLSP");
  g_exc_stauLSP->SetTitle("g_exc_stauLSP");
  g_exc_stauLSP->SetFillColor(100);
  g_exc_stauLSP->SetMarkerStyle(20);
  g_exc_stauLSP->SetMarkerSize(1.2);
  g_exc_stauLSP->SetPoint(0,156.3629386,770.25);
  g_exc_stauLSP->SetPoint(1,151.7020349,750.75);
  g_exc_stauLSP->SetPoint(2,151.1875,749.3895349);
  g_exc_stauLSP->SetPoint(3,146.578125,731.25);
  g_exc_stauLSP->SetPoint(4,143.8125,720.85);
  g_exc_stauLSP->SetPoint(5,141.2735656,711.75);
  g_exc_stauLSP->SetPoint(6,137.7920918,692.25);
  g_exc_stauLSP->SetPoint(7,136.4375,688.6683673);
  g_exc_stauLSP->SetPoint(8,131.967803,672.75);
  g_exc_stauLSP->SetPoint(9,129.0625,662.8088235);
  g_exc_stauLSP->SetPoint(10,126.2259615,653.25);
  g_exc_stauLSP->SetPoint(11,123.4964623,633.75);
  g_exc_stauLSP->SetPoint(12,121.6875,628.9669811);
  g_exc_stauLSP->SetPoint(13,117.3492647,614.25);
  g_exc_stauLSP->SetPoint(14,114.3125,604.6710526);
  g_exc_stauLSP->SetPoint(15,111.2128623,594.75);
  g_exc_stauLSP->SetPoint(16,108.2920918,575.25);
  g_exc_stauLSP->SetPoint(17,106.9375,571.6683673);
  g_exc_stauLSP->SetPoint(18,102.7232143,555.75);
  g_exc_stauLSP->SetPoint(19,99.5625,546.4642857);
  g_exc_stauLSP->SetPoint(20,96.22859589,536.25);
  g_exc_stauLSP->SetPoint(21,93.00694444,516.75);
  g_exc_stauLSP->SetPoint(22,92.1875,514.5833333);
  g_exc_stauLSP->SetPoint(23,88.09027778,497.25);
  g_exc_stauLSP->SetPoint(24,84.8125,488.2065217);
  g_exc_stauLSP->SetPoint(25,81.26866883,477.75);
  g_exc_stauLSP->SetPoint(26,77.4375,459.9091949);
  g_exc_stauLSP->SetPoint(27,76.80998399,458.25);
  g_exc_stauLSP->SetPoint(28,73.50416667,438.75);
  g_exc_stauLSP->SetPoint(29,70.0625,429.6354167);
  g_exc_stauLSP->SetPoint(30,66.38053956,419.25);
  g_exc_stauLSP->SetPoint(31,62.6875,401.1104651);
  g_exc_stauLSP->SetPoint(32,62.17296512,399.75);
  g_exc_stauLSP->SetPoint(33,58.8525,380.25);
  g_exc_stauLSP->SetPoint(34,58.75416667,360.75);
  g_exc_stauLSP->SetPoint(35,55.3125,351);
  g_exc_stauLSP->SetPoint(36,51.87083333,341.25);
  g_exc_stauLSP->SetPoint(37,47.9375,322.5);
  g_exc_stauLSP->SetPoint(38,47.65384615,321.75);
  g_exc_stauLSP->SetPoint(39,40.5625,310.7640845);
  g_exc_stauLSP->SetPoint(40,37.34242958,302.25);
  g_exc_stauLSP->SetPoint(41,33.1875,283.5);
  g_exc_stauLSP->SetPoint(42,32.90384615,282.75);
  g_exc_stauLSP->SetPoint(43,30.21548507,263.25);
  g_exc_stauLSP->SetPoint(44,25.8125,251.25);
  g_exc_stauLSP->SetPoint(45,22.97596154,243.75);
  g_exc_stauLSP->SetPoint(46,18.4375,231.3690476);
  g_exc_stauLSP->SetPoint(47,15.74503968,224.25);
  g_exc_stauLSP->SetPoint(48,11.0625,211.4631148);
  g_exc_stauLSP->SetPoint(49,3.6875,210.7738424);
  g_exc_stauLSP->SetPoint(49,-50,210.7738424);
  g_exc_stauLSP->SetPoint(50,-50,770.25);
  g_exc_stauLSP->SetFillColor(kViolet-9);
  g_exc_stauLSP->SetLineColor(kGray+1);

  return g_exc_stauLSP;
}

void smoothHisto(TH2* hist, int Niter) {

  for(int iter=0; iter<Niter; iter++) {
    if(iter>2) {
      TH2* clone = (TH2*) hist->Clone("clone");
      for(int ix=2; ix<hist->GetNbinsX()-1; ix++) {
	for(int iy=2; iy<hist->GetNbinsY()-1; iy++) {
	  double nn1 = clone->GetBinContent(ix-1,iy);
	  double nn2 = clone->GetBinContent(ix,iy-1);
	  double nn3 = clone->GetBinContent(ix+1,iy);
	  double nn4 = clone->GetBinContent(ix,iy+1);
	  hist->SetBinContent(ix,iy,0.25*(nn1+nn2+nn3+nn4));
	}
      }
      delete clone;
    } else {
      TH2* clone = (TH2*) hist->Clone("clone");
      for(int ix=2; ix<hist->GetNbinsX()-1; ix++) {
	for(int iy=2; iy<hist->GetNbinsY()-1; iy++) {
	  double nn1 = clone->GetBinContent(ix-1,iy-1);
	  double nn2 = clone->GetBinContent(ix-1,iy+1);
	  double nn3 = clone->GetBinContent(ix+1,iy-1);
	  double nn4 = clone->GetBinContent(ix+1,iy+1);
	  if(nn1+nn2+nn3+nn4>2 && hist->GetBinContent(ix,iy))
	    hist->SetBinContent(ix,iy,1.);
	  else
	    hist->SetBinContent(ix,iy,0.25*(nn1+nn2+nn3+nn4));
	}
      }
      delete clone;      
    }
  }
}

void msugraThExcl(TString msugrafile = "msugra_status.txt",
		  TGraph* staulsp=0, TGraph* negmasssq=0, TGraph* noRGE=0,
		  TGraph* noEWSB=0, TGraph* tachyons=0,
		  TString chrgfile="mSugraGridtanbeta10_charginoMasses.root", TGraph* lepchrg=0) {
  TTree msugra;
  msugra.ReadFile(msugrafile);
  
  float m0, m12;
  int status;

  msugra.SetBranchAddress("m0",&m0);
  msugra.SetBranchAddress("m12",&m12);
  msugra.SetBranchAddress("status",&status);

  TH2D *stat1hist = new TH2D("stat1hist","stat1hist",250,0,5000,100,0,1000);
  TH2D *stat2hist = new TH2D("stat2hist","stat2hist",250,0,5000,100,0,1000);
  TH2D *stat3hist = new TH2D("stat3hist","stat3hist",250,0,5000,100,0,1000);
  TH2D *stat4hist = new TH2D("stat4hist","stat4hist",250,0,5000,100,0,1000);
  TH2D *stat5hist = new TH2D("stat5hist","stat5hist",250,0,5000,100,0,1000);
  for(int i=0; i<msugra.GetEntries(); i++) {
    msugra.GetEntry(i);
    switch(status) {
    case 5:
      stat5hist->Fill(m0-1,m12-1,1);
    case 3:
      stat3hist->Fill(m0-1,m12-1,1);
    case 4:
      stat4hist->Fill(m0-1,m12-1,1);
    case 2:
      stat2hist->Fill(m0-1,m12-1,1);
      break;
    case 1:
      stat1hist->Fill(m0-1,m12-1,1);
    default: break;
    }
  }

  smoothHisto(stat1hist,3);
  smoothHisto(stat2hist,3);
  smoothHisto(stat3hist,3);
  smoothHisto(stat4hist,3);
  smoothHisto(stat5hist,3);

  stat1hist->SetContour(1);
  stat1hist->SetContourLevel(0,0.5);

  stat2hist->SetContour(1);
  stat2hist->SetContourLevel(0,0.5);

  stat3hist->SetContour(1);
  stat3hist->SetContourLevel(0,0.5);

  stat4hist->SetContour(1);
  stat4hist->SetContourLevel(0,0.5);

  stat5hist->SetContour(1);
  stat5hist->SetContourLevel(0,0.5);

  TCanvas* c = new TCanvas;

  /// DRAW STAU LSP
  stat1hist->Draw("contlist");
  c->Update();

  if (!staulsp) staulsp = new TGraph;
  TObjArray* conts_1 = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_1 = (TList*) conts_1->At(0);
  TGraph* mystaulsp = (TGraph*) cont_1->At(1);
  for(int pt=0; pt<mystaulsp->GetN(); pt++) {
    staulsp->SetPoint(pt,mystaulsp->GetX()[pt],mystaulsp->GetY()[pt]);
  }
  staulsp->SetPoint(staulsp->GetN(),-10,-10);
  staulsp->SetPoint(staulsp->GetN(),-10,1010);
  staulsp->SetPoint(staulsp->GetN(),200,1010);
  staulsp->SetFillColor(kBlue);
  staulsp->SetLineColor(kGray+2);
  staulsp->SetLineWidth(2);

  /// DRAW -VE MASS SQUARED
  stat2hist->Draw("contlist");
  c->Update();

  if (!negmasssq) negmasssq = new TGraph;
  TObjArray* conts_2 = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_2 = (TList*) conts_2->At(0);
  TGraph* mynegmasssq = (TGraph*) cont_2->At(0);
  for(int pt=0; pt<mynegmasssq->GetN(); pt++) {
    negmasssq->SetPoint(pt,mynegmasssq->GetX()[pt],mynegmasssq->GetY()[pt]);
  }
  negmasssq->SetPoint(negmasssq->GetN(),5010,1010);
  negmasssq->SetPoint(negmasssq->GetN(),5010,-10);
  negmasssq->SetPoint(negmasssq->GetN(),-10,-10);
  negmasssq->SetFillColor(kAzure+1);
  negmasssq->SetLineColor(kGray+2);
  negmasssq->SetLineWidth(2);

  /// DRAW NO RGE
  stat4hist->Draw("contlist");
  c->Update();

  if(!noRGE) noRGE = new TGraph;
  TObjArray* conts_4 = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_4 = (TList*) conts_4->At(0);
  TGraph* mynoRGE = (TGraph*) cont_4->At(1);
  mynoRGE->SetPoint(mynoRGE->GetN(),5010,875);
  mynoRGE->SetPoint(mynoRGE->GetN(),5010,-10);
  for(int pt=0; pt<mynoRGE->GetN(); pt++) {
    noRGE->SetPoint(pt,mynoRGE->GetX()[pt],mynoRGE->GetY()[pt]);
  }
  noRGE->SetFillColor(kViolet-8);
  noRGE->SetLineColor(kGray+2);
  noRGE->SetLineWidth(1);

  stat3hist->Draw("contlist");
  c->Update();

  /// DRAW NO EWSB
  if(!noEWSB) noEWSB = new TGraph;
  TObjArray* conts_3 = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_3 = (TList*) conts_3->At(0);
  TGraph* mynoEWSB = (TGraph*) cont_3->At(1);
  mynoEWSB->SetPoint(mynoEWSB->GetN(),5010,810);
  mynoEWSB->SetPoint(mynoEWSB->GetN(),5010,-10);
  mynoEWSB->SetPoint(mynoEWSB->GetN(),500,-10);
  for(int pt=0; pt<mynoEWSB->GetN(); pt++) {
    noEWSB->SetPoint(pt,mynoEWSB->GetX()[pt],mynoEWSB->GetY()[pt]);
  }
  noEWSB->SetFillColor(kGreen+2);
  noEWSB->SetLineColor(kGray+2);
  noEWSB->SetLineWidth(1);

  stat5hist->Draw("contlist");
  c->Update();

  /// DRAW TACHYONS
  if(!tachyons) tachyons = new TGraph;
  TObjArray* conts_5 = (TObjArray*) gROOT->GetListOfSpecials()->FindObject("contours");
  TList* cont_5 = (TList*) conts_5->At(0);
  TGraph* mytachyons = (TGraph*) cont_5->At(0);
  mytachyons->SetPoint(mytachyons->GetN(),350,-10);
  mytachyons->SetPoint(mytachyons->GetN(),-10,-10);
  mytachyons->SetPoint(mytachyons->GetN(),-10,80);
  for(int pt=0; pt<mytachyons->GetN(); pt++) {
    tachyons->SetPoint(pt,mytachyons->GetX()[pt],mytachyons->GetY()[pt]);
  }
  tachyons->SetFillColor(kRed);
  tachyons->SetLineColor(kGray+2);
  tachyons->SetLineWidth(1);

  lepchrg = msugra_lepchrg(chrgfile);

  TH2D frame("frame","frame",10,0,5010,10,0,1000);
  frame.Draw();

  lepchrg->Draw("f");
  lepchrg->Draw("l");
  staulsp->Draw("f");
  negmasssq->Draw("f");
  noRGE->Draw("f");
  noRGE->Draw("l");
  noEWSB->Draw("f");
  noEWSB->Draw("l");
  tachyons->Draw("f");
  tachyons->Draw("l");
  negmasssq->Draw("l");
  staulsp->Draw("l");

  c->RedrawAxis();
}

TGraph* msugraThExcl_mglmsq() {

  // A quadratic in msq describes the shape of the curve really well!
  TF1 thexcl_quad("thexcl_quad","(x-[1])*(x-[1])/[0]+[2]",0,3500);
  thexcl_quad.SetParameter(0,7250);
  thexcl_quad.SetParameter(1,750);
  thexcl_quad.SetParameter(2,100);

  TGraph* thexcl = new TGraph(75);
  // The lowest allowed mass ratio of m_sq : m_gl is 0.89
  thexcl->SetPoint(0,2500,0);
  thexcl->SetPoint(1,2500,2225);
  thexcl->SetPoint(2,2500,2225);
  thexcl->SetPoint(3,150,150);
  for(int i=1; i<68; i++) {
    thexcl->SetPoint(i+3,thexcl_quad.Eval(150+50*i),150+50*i);
  }
  thexcl->SetPoint(71,2500,5400);
  thexcl->SetPoint(72,0,5400);
  thexcl->SetPoint(73,0,0);
  thexcl->SetPoint(74,2500,0);
  thexcl->SetLineColor(kGray+2);
  thexcl->SetFillColor(kAzure+1);

  TCanvas* c = new TCanvas;

  thexcl->Draw("af");
  thexcl->Draw("l");

  c->RedrawAxis();

  return thexcl;
}
